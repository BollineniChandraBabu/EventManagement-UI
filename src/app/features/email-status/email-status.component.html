<div class="page"><mat-card>
    <h2>Email Status</h2>
    <table mat-table [dataSource]="(items$ | async) ?? []">
      <ng-container matColumnDef="to"><th mat-header-cell *matHeaderCellDef>To</th><td mat-cell *matCellDef="let e">{{e.to}}</td></ng-container>
      <ng-container matColumnDef="subject"><th mat-header-cell *matHeaderCellDef>Subject</th><td mat-cell *matCellDef="let e">{{e.subject}}</td></ng-container>
      <ng-container matColumnDef="status"><th mat-header-cell *matHeaderCellDef>Status</th><td mat-cell *matCellDef="let e">{{e.status}}</td></ng-container>
      <ng-container matColumnDef="actions"><th mat-header-cell *matHeaderCellDef>Actions</th><td mat-cell *matCellDef="let e"><button mat-button *ngIf="isAdmin && e.status==='FAILED'" (click)="retry(e.id)">Retry</button><span *ngIf="!isAdmin">Read only</span></td></ng-container>
      <tr mat-header-row *matHeaderRowDef="cols"></tr>
      <tr mat-row *matRowDef="let row; columns: cols;"></tr>
    </table>
    <div class="alert alert-info mt-3" *ngIf="!isAdmin">Read-only access: only admins can retry failed emails.</div>
  </mat-card></div>
